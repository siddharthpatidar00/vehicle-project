<div class="fixed inset-0 z-[50] flex justify-center items-center bg-black bg-opacity-50 p-2 sm:p-4">
    <div
        class="bg-white w-full max-w-[95%] sm:max-w-[600px] md:max-w-[800px] p-4 sm:p-6 rounded-md shadow-lg overflow-y-auto max-h-[90vh]">
        <!-- Header -->
        <div class="flex justify-between items-center mb-4">
            <p class="text-lg sm:text-xl font-semibold text-gray-800">
                Send vehicle sell inquiry
            </p>
            <span (click)="closeModal()"
                class="text-red-500 text-3xl sm:text-5xl cursor-pointer leading-none">&times;</span>
        </div>

        <!-- Form -->
        <form [formGroup]="vehicleForm" (ngSubmit)="onSubmit()" class="space-y-3 sm:space-y-4">

            <!-- Row 1 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                    <label class="block text-sm font-semibold text-black mb-1">Vehicle Name</label>
                    <input type="text" formControlName="name" placeholder="Enter vehicle name"
                        class="w-full px-4 py-3 text-sm sm:text-lg border border-gray-300 rounded-md" />
                    <div *ngIf="hasError('name')" class="text-red-500 text-xs mt-1">{{ getError('name') }}</div>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-black mb-1">Model</label>
                    <input type="text" formControlName="model" placeholder="Enter vehicle model"
                        class="w-full px-4 py-3 text-sm sm:text-lg border border-gray-300 rounded-md" />
                    <div *ngIf="hasError('model')" class="text-red-500 text-xs mt-1">{{ getError('model') }}</div>
                </div>
            </div>

            <!-- Row 2 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">

                <div class="relative">
                    <label class="block text-sm font-semibold text-black mb-1">Brand</label>
                    <div class="relative inline-block w-full">
                        <button type="button" (click)="brandDropdownOpen = !brandDropdownOpen"
                            class="w-full px-4 py-3 border border-gray-300 rounded text-left bg-white flex justify-between items-center">
                            {{ selectedBrand || 'Select option' }}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        <!-- Options -->
                        <ul *ngIf="brandDropdownOpen"
                            class="absolute left-0 mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 min-w-max !text-left">
                            <li *ngFor="let brand of brands" (click)="selectBrand(brand.brand_name)"
                                class="px-3 py-1 cursor-pointer hover:bg-gray-100 whitespace-nowrap ml-[-35px]">
                                {{ brand.brand_name }}
                            </li>
                        </ul>
                    </div>
                     <div *ngIf="hasError('brand')" class="text-red-500 text-xs mt-1">{{ getError('brand') }}</div>
                </div>

                <div class="relative">
                    <label class="block text-sm font-semibold text-black mb-1">Category</label>
                    <div class="relative inline-block w-full">
                        <button type="button" (click)="categoryDropdownOpen = !categoryDropdownOpen"
                            class="w-full px-4 py-3 border border-gray-300 rounded text-left bg-white flex justify-between items-center">
                            {{ selectedCategory || 'Select option' }}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>

                        <!-- Options -->
                        <ul *ngIf="categoryDropdownOpen"
                            class="absolute left-0 mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 min-w-max !text-left">
                            <li *ngFor="let category of categories" (click)="selectCategory(category.category_name)"
                                class="px-3 py-1 cursor-pointer hover:bg-gray-100 whitespace-nowrap ml-[-30px]">
                                {{ category.category_name }}
                            </li>
                        </ul>
                    </div>
                    <div *ngIf="hasError('category')" class="text-red-500 text-xs mt-1">{{ getError('category') }}</div>
                </div>

            </div>

            <!-- Row 3 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                    <label class="block text-sm font-semibold text-black mb-1">K.M. Driven</label>
                    <input type="number" formControlName="km_driven" placeholder="Enter K.M. driven"
                        class="w-full px-4 py-3 text-sm sm:text-lg border border-gray-300 rounded-md" />
                </div>
                <div class="relative">
                    <label class="block text-sm font-semibold text-black mb-1">Ownership</label>
                    <div class="relative inline-block w-full">
                        <button type="button" (click)="ownershipDropdownOpen = !ownershipDropdownOpen"
                            class="w-full px-4 py-3 border border-gray-300 rounded text-left bg-white flex justify-between items-center">
                            {{ selectedOwnership || 'Select option' }}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>

                        <ul *ngIf="ownershipDropdownOpen"
                            class="absolute left-0 mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 min-w-max !text-left">
                            <li *ngFor="let option of ownershipOptions" (click)="selectOwnership(option)"
                                class="px-3 py-1 cursor-pointer hover:bg-gray-100 whitespace-nowrap ml-[-30px]">
                                {{ option }}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Row 4 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                    <label class="block text-sm font-semibold text-black mb-1">Manufacture Year</label>
                    <input type="number" formControlName="manufacture_year"
                        class="w-full px-4 py-3 text-sm sm:text-lg border border-gray-300 rounded-md" />
                        <div *ngIf="hasError('manufacture_year')" class="text-red-500 text-xs mt-1">{{ getError('manufacture_year') }}</div>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-black mb-1">Price</label>
                    <input type="number" formControlName="price"
                        class="w-full px-4 py-3 text-sm sm:text-lg border border-gray-300 rounded-md" />
                    </div>
            </div>

            <!-- Row 5 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div>
                    <label class="block text-sm font-semibold text-black mb-1">Insurance Valid Till</label>
                    <input type="date" formControlName="insuranceValidTill"
                        class="w-full px-4 py-3 text-sm sm:text-lg border border-gray-300 rounded-md" />
                </div>
                <div class="relative">
                    <label class="block text-sm font-semibold text-black mb-1">Insured</label>
                    <div class="relative inline-block w-full">
                        <button type="button" (click)="insuredDropdownOpen = !insuredDropdownOpen"
                            class="w-full px-4 py-3 border border-gray-300 rounded text-left bg-white flex justify-between items-center">
                            {{ selectedInsured !== null ? (selectedInsured ? 'Yes' : 'No') : 'Select option' }}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>

                        <ul *ngIf="insuredDropdownOpen"
                            class="absolute left-0 mt-1 bg-white border border-gray-300 rounded shadow-lg z-50 min-w-max">
                            <li (click)="selectInsured(true)"
                                class="px-3 py-1 cursor-pointer hover:bg-gray-100 whitespace-nowrap ml-[-30px]">Yes</li>
                            <li (click)="selectInsured(false)"
                                class="px-3 py-1 cursor-pointer hover:bg-gray-100 whitespace-nowrap ml-[-30px]">No</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Row 6 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                <div class="relative">
                    <label class="block text-sm font-semibold text-black mb-1">Sell</label>
                    <div class="relative inline-block w-full">
                        <button type="button" (click)="sellDropdownOpen = !sellDropdownOpen"
                            class="w-full px-4 py-3 border border-gray-300 rounded text-left bg-white flex justify-between items-center">
                            {{ selectedSell || 'Select option' }}
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-2" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>

                        <ul *ngIf="sellDropdownOpen"
                            class="absolute left-0 mt-1 bg-white border border-gray-300 rounded-md shadow-lg z-50 min-w-max !text-left">
                            <li (click)="selectSell('Sell')"
                                class="px-3 py-1 cursor-pointer hover:bg-gray-100 whitespace-nowrap ml-[-30px]">Sell</li>
                            <li (click)="selectSell('Rent')"
                                class="px-3 py-1 cursor-pointer hover:bg-gray-100 whitespace-nowrap ml-[-30px]">Rent</li>
                        </ul>
                    </div>
                    <div *ngIf="hasError('sell_or_rent')" class="text-red-500 text-xs mt-1">{{ getError('sell_or_rent') }}</div>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-black mb-1">Phone Number</label>
                    <input type="text" formControlName="phone" placeholder="Enter phone number"
                        class="w-full px-4 py-3 text-sm sm:text-lg border border-gray-300 rounded-md" />
                         <div *ngIf="hasError('phone')" class="text-red-500 text-xs mt-1">{{ getError('phone') }}</div>
                </div>
            </div>

            <!-- File Upload -->
            <div>
                <label class="block text-sm font-semibold text-black mb-1">Upload Vehicle Images (Max 5)</label>
                <input type="file" accept="image/*" multiple (change)="onFilesSelected($event)" class="w-full border rounded px-3 py-2 text-sm cursor-pointer
                 file:mr-3 file:py-1 file:px-3 file:rounded file:border-0
                 file:bg-[#fcb026] file:text-black hover:file:bg-[#ffa600]" />
                <div *ngIf="imagePreviews.length > 0" class="mt-3 grid grid-cols-2 sm:grid-cols-3 gap-4">
                    <div *ngFor="let preview of imagePreviews; let i = index"
                        class="relative w-32 h-32 border rounded-lg overflow-hidden shadow-md">
                        <img [src]="preview" alt="Preview" class="w-full h-full object-cover" />
                        <button type="button" (click)="removeImage(i)"
                            class="absolute top-1 right-1 bg-red-600 text-white rounded-full w-7 h-7 flex items-center justify-center shadow hover:bg-red-700">
                            ✕
                        </button>
                    </div>
                </div>
                 <div *ngIf="hasError('img')" class="text-red-500 text-xs mt-1">{{ getError('img') }}</div>
            </div>

            <!-- Description -->
            <div>
                <label class="block text-sm font-semibold text-black mb-1">Description</label>
                <textarea formControlName="description" placeholder="Short description..."
                    class="w-full border rounded px-3 py-2 text-sm sm:text-base"></textarea>
                     <div *ngIf="hasError('description')" class="text-red-500 text-xs mt-1">{{ getError('description') }}</div>
            </div>

            <!-- Submit Button -->
            <button type="submit"
                class="w-full mt-2.5 bg-[#fcb026] hover:bg-[#fcb126d7] text-black py-3 rounded-md text-lg sm:text-xl font-semibold flex items-center justify-center gap-3">
                Submit for Listing <span class="text-xl sm:text-2xl">&rarr;</span>
            </button>
        </form>
    </div>
</div>